<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>BAG Quote Test</title>
  <style>body{font:16px/1.4 system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:2rem;max-width:720px}</style>
</head>
<body>
  <h1>BAG Quote Test</h1>
  <label>$ USD:&nbsp;<input id="usd" type="number" step="0.01" min="1" value="5"></label>
  <button id="go">Get Quote</button>
  <pre id="out">Ready.</pre>

  <script>
    const API_BASE = 'https://api.getthebag.io';

    async function getQuote(usd) {
      const url = `${API_BASE}/api/quote?usd=${encodeURIComponent(usd)}`;
      const res = await fetch(url, { method: 'GET', mode: 'cors', credentials: 'omit' });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();
      if (!data.ok) throw new Error(data.error || 'quote failed');
      return data;
    }

    document.getElementById('go').addEventListener('click', async () => {
      const out = document.getElementById('out');
      const usd = Number(document.getElementById('usd').value || 0);
      out.textContent = 'Fetching…';
      try {
        const q = await getQuote(usd);
        out.textContent = JSON.stringify(q, null, 2);
      } catch (e) {
        out.textContent = '⚠️ Could not fetch quote\n' + e;
        console.error(e);
      }
    });
  </script>
</body>
</html>
