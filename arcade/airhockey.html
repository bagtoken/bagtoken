<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>$BAG Air Hockey â€” Arcade P2E</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
<style>
body{margin:0;background:#021107;overflow:hidden;}
canvas{display:block;margin:auto;}
</style>
</head>
<body>
<script>
const config={
  type:Phaser.AUTO,
  width:window.innerWidth,
  height:window.innerHeight,
  physics:{default:'arcade',arcade:{debug:false}},
  scene:{preload,create,update}
};
let puck,p1,p2,cursors,score1=0,score2=0,scoreText,cpu=true;

const game=new Phaser.Game(config);

function preload(){
  this.load.image('table','/arcade/assets/img/airhockey_table.png');
  this.load.image('puck','/arcade/assets/img/puck.png');
  this.load.image('paddle1','/arcade/assets/img/paddle_gold.png');
  this.load.image('paddle2','/arcade/assets/img/paddle_green.png');
}
function create(){
  this.add.image(config.width/2,config.height/2,'table')
      .setDisplaySize(config.width,config.height);
  puck=this.physics.add.image(config.width/2,config.height/2,'puck').setScale(0.08);
  p1=this.physics.add.image(config.width/2,config.height*0.2,'paddle1').setScale(0.1);
  p2=this.physics.add.image(config.width/2,config.height*0.8,'paddle2').setScale(0.1);
  puck.setCollideWorldBounds(true).setBounce(1);
  p1.setCollideWorldBounds(true);
  p2.setCollideWorldBounds(true);
  this.physics.add.collider(puck,p1);
  this.physics.add.collider(puck,p2);

  this.input.on('pointermove',pointer=>{
    p1.x=Phaser.Math.Clamp(pointer.x,50,config.width-50);
    p1.y=Phaser.Math.Clamp(pointer.y,50,config.height/2-20);
  });

  scoreText=this.add.text(config.width/2,20,`0 - 0`,
      {fontFamily:'Orbitron',fontSize:'32px',color:'#ffe175'}).setOrigin(0.5,0);

  cursors=this.input.keyboard.createCursorKeys();
}
function update(){
  if(!cpu){
    if(cursors.up.isDown)p2.y-=6;
    else if(cursors.down.isDown)p2.y+=6;
  }else{
    // simple AI
    this.physics.moveToObject(p2,puck,150);
    if(p2.y<config.height/2+50)p2.setVelocityY(100);
  }
  // goal check
  if(puck.y<10){score2++;resetPuck.call(this);}
  if(puck.y>config.height-10){score1++;resetPuck.call(this);}
}
function resetPuck(){
  puck.setPosition(config.width/2,config.height/2);
  puck.setVelocity(Phaser.Math.Between(-200,200),Phaser.Math.Between(-300,300));
  scoreText.setText(`${score1} - ${score2}`);
}
</script>
</body>
</html>
